# rollup-plugin-svgi

[![npm@latest](https://badgen.net/npm/v/rollup-plugin-svgi)](https://www.npmjs.com/package/rollup-plugin-svgi)
[![dependencies](https://david-dm.org/kuzivany/rollup-plugin-svgi.svg)](https://david-dm.org/kuzivany/rollup-plugin-svgi)

Import SVG files as JSX components.

## Purpose

- `import` SVG as components in [Preact](http://preactjs.com/), [React](https://reactjs.org/) and other libraries using [Rollup](http://rollupjs.org/).
- Use inline SVG

## Installation

Get started by installing `rollup-plugin-svgi` from your terminal with your preferred package manager:

### `npm`

```bash
npm install rollup-plugin-svgi --save-dev
```

### [`yarn`](http://yarnpkg.com/)

```bash
yarn add rollup-plugin-svgi -D
```

## Usage

```js
// rollup.config.js
import svgi from 'rollup-plugin-svgi';

const config = {/* ... */};

export default {
  entry: 'main.js',
  plugins: [
    svgi(config)
  ]
}
```

### Configuration

The `config` object passed to the plugin is composed of the following properties:

| Property | Description | Default |
| -------- | ----------- | ------- |
| `options` | The options object | `undefined` |
| `options.jsx` | The JSX library to use e.g. `"preact"` or `"react"` | `undefined` |
| `options.factory` | The JSX [pragma](https://jasonformat.com/wtf-is-jsx/#thepragma) or name of the function called at runtime for each node e.g. `preact.h` or `React.createElement` | `undefined` |
| `options.default` | Whether or not the `options.factory` is the `default` export of the provided `options.jsx` library.<br/>If `false`, the provided `options.jsx` will be a [named `export`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/export#Description) | `true` |
| `options.clean` | The function used to clean up/ prepare the SVG for inlining. It has a `(rawSVG) => string` or `(rawSVG) => Promise<string>` function signature and removes the `DOCTYPE`, XML declaration, comments and namespaced attributes | [`function`](./index.js#L30) |
| `exclude` | Minimatch pattern(s) to exclude.<br/>[More at rollupjs.org](https://rollupjs.org/guide/en#transformers). | `undefined` |
| `include` | Minimatch pattern(s) to include.<br/>[More at rollupjs.org](https://rollupjs.org/guide/en#transformers). | `"**/*.svg"` |

### Examples

Here are some complete `rollup.config.js` and starter project examples for:
- [Preact](https://github.com/kuzivany/simple-preact-rollup)
- [React, Inferno](https://github.com/kuzivany/simple-rollup-starter)

#### Basic example

```js
// main.js
import { h } from 'preact'; // OR import React from 'react';
import Logo from 'path/to/logo.svg';

export default () => (
  <div class="App">
    <div class="App-header">
      <Logo class="App-logo" />
    </div>
  </div>
);
```

```js
// rollup.config.js
import svgi from 'rollup-plugin-svgi';

export default {
  entry: 'main.js',
  // ...
  plugins: [
    svgi({
      options: {
        jsx: "preact", // Your chosen JSX library
      },
    }),
  ]
}
```

#### Advanced examples

##### Specifying a library

```js
// rollup.config.js
import svgi from 'rollup-plugin-svgi';

export default {
  entry: 'main.js',
  plugins: [
    svgi({
      options: {
        jsx: "inferno-create-element",
        factory: "createElement",
        'default': false // import { createElement } from 'inferno-create-element';
      },
    }),
  ]
}
```

##### Using SVGO

`options.clean` allows you to specify a custom function to remove any unnecessary elements in your SVG files. [SVGO](https://github.com/svg/svgo) can be used in `options.clean`:

```js
// rollup.config.js
import svgi from 'rollup-plugin-svgi';
import SVGO from "svgo";

export default {
  entry: 'main.js',
  plugins: [
    svgi({
      options: {
        jsx: "react",
        clean: rawSVG => (
          new SVGO({
            plugins: [
              {removeDoctype: true},
              {removeXMLNS: true},
              {removeComments: true},
              {removeViewBox: false},
            ]
          }).optimize(rawSVG).then(optzSvg => optzSvg.data)
        )
      }
    })
  ]
}
```

## Internals

SVG files are `import`ed as functional components which accept `props`:

```xml
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by hand -->
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="100%" height="100%" version="1.1" viewBox="-50 -50 100 100">
  <circle cx="0" cy="0" fill="red" r="25"/>
</svg>
```

```jsx
import Logo from 'path/to/logo.svg';
```

pretty much does this:

```jsx
const Logo = props => (
  <svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" version="1.1" viewBox="-50 -50 100 100" {...props}>
    <circle cx="0" cy="0" fill="red" r="25"/>
  </svg>
)
```
